---
title: "Introduction to Mathematical Optimization and Mixed-Integer Programming"
author: "Yuanzhe(Roger) Li"
date: "11/12/2019"
output:
  beamer_presentation: 
    colortheme: seagull
    fonttheme: professionalfonts
    theme: Rochester
urlcolor: blue
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
options(tinytex.verbose = TRUE)
library(dplyr)
library(ggplot2)
library(ompr)
library(ompr.roi)
library(ROI.plugin.glpk)
```

## R Markdown

This is an R Markdown presentation. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document.

## Overview

- Mathematical Optimization
- Mixed-Integer Programs
  - Examples 

## Overview of Mathematical Optimization


## Mixed-Integer Programs

$$\begin{aligned}
\max \quad & f(x)\\
s.t. \quad & g(x) \leq 0 \\
& x \in \mathbb{R} \times \mathbb{Z}
\end{aligned}$$



## Portfolio Optimization


## Traveling Salesman Problem
- [TSP wikipedia page](https://en.wikipedia.org/wiki/Travelling_salesman_problem)

> The travelling salesman problem (TSP) asks the following question: Given a list of cities and the distances between each pair of cities, what is the shortest possible route that visits each city exactly once and returns to the origin city?

```{r tsp_setup, fig.width=4, fig.height=1.8, fig.align='center'}
# number of cities
n <- 10
# boundary of euclidean space
max_x <- 500
max_y <- 250
set.seed(9102)

cities <- data.frame(
  id = 1:n
  ,x = runif(n, max = max_x)
  ,y = runif(n, max = max_y)
  )
ggplot(cities, aes(x, y),label = id) + 
  geom_point() + 
  geom_text(aes(label=id),color = "blue",hjust=1.5, vjust=0.5) + 
  geom_segment(
    aes(
      x = cities %>% filter(id==5) %>% pull(x)
      ,y = cities %>% filter(id==5) %>% pull(y)
      ,xend = cities %>% filter(id==9) %>% pull(x)
      ,yend = cities %>% filter(id==9) %>% pull(y)
      )
    ) +
  annotate("text", label="d = 99.74", x= 105, y=160, color="red", size=2.5) + 
  xlab("x coordinate") + 
  ylab("y coordinate") + 
  xlim(0,500) + ylim(0,250) + 
  ggtitle("TSP example with 10 cities") +
  theme_light()

# Add distances and dist_fun
distance <- as.matrix(
  stats::dist(select(cities, x, y)
  ,diag = TRUE
  ,upper = TRUE)
  )
dist_fun <- function(i, j) {
  vapply(seq_along(i), function(k) distance[i[k], j[k]], numeric(1L))
}

```

## 
Add distance to the figure